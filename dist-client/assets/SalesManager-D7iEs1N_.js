import{c as A,r as t,j as e,L as u,X as f,a as b,p as j}from"./index-CFXgF25F.js";import{P as R}from"./plus-CrLdviO7.js";import{S as V}from"./square-pen-CCrpNvAB.js";import{D as k}from"./dollar-sign-CrpTMmIA.js";import{C as X}from"./calendar-C6jeWWk-.js";import{S as q}from"./save-VOrKx8th.js";import{U as $}from"./user-B-hCEkTO.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=A("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=A("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),ae=()=>{const[N,v]=t.useState([]),[E,w]=t.useState(!0),[M,d]=t.useState(!1),[i,l]=t.useState(!1),[n,c]=t.useState({monthly:0,quarterly:0}),[I,U]=t.useState(!0),[x,P]=t.useState(null),[F,m]=t.useState(!1),[s,g]=t.useState({name:"",email:"",password:""}),[S,y]=t.useState(""),[L,C]=t.useState(!1),h=async()=>{w(!0);try{const a=await b.get("/users/salespeople");if(a)v(a),C(!1);else throw new Error("No data")}catch(a){console.warn("Failed to fetch sales team from API, using local data",a),C(!0);const o=j.users.getSalespeople();v(o.map(r=>({...r,totalSales:r.totalSales||0})))}finally{w(!1)}};t.useEffect(()=>{h()},[]);const O=a=>{P(a),c({monthly:a.target||0,quarterly:a.quarterlyTarget||a.target*3}),U(!0),d(!0)},T=(a,o)=>{const r=parseFloat(o)||0;c(I?a==="quarterly"?{quarterly:r,monthly:parseFloat((r/3).toFixed(2))}:{monthly:r,quarterly:r*3}:Q=>({...Q,[a]:r}))},D=async()=>{if(x){l(!0);try{await b.patch(`/users/${x.id}/target`,{monthlyTarget:n.monthly,quarterlyTarget:n.quarterly})}catch(a){console.warn("Failed to update target via API, saving locally.",a),j.users.update(x.id,{target:n.monthly,quarterlyTarget:n.quarterly})}finally{await h(),d(!1),l(!1)}}},z=()=>{g({name:"",email:"",password:""}),y(""),m(!0)},B=async a=>{if(a.preventDefault(),l(!0),y(""),!s.email||!s.name||!s.password){y("All fields are required."),l(!1);return}try{await b.post("/users/salespeople",s)}catch(o){console.warn("Creation via API failed, adding locally.",o);try{j.users.add({...s,role:"SALESPERSON",totalSales:0,target:0,quarterlyTarget:0})}catch(r){y(r.message||"Failed to create user"),l(!1);return}}await h(),m(!1),l(!1)},p=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-navy-900 flex items-center gap-2",children:["Sales Team Management",L&&e.jsx("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-0.5 rounded-full",children:"Offline Mode"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Set monthly and quarterly targets for your sales force."})]}),e.jsxs("button",{onClick:z,className:"bg-navy-900 hover:bg-navy-800 text-white px-4 py-2 rounded shadow flex items-center gap-2 text-sm font-bold transition",children:[e.jsx(R,{className:"w-4 h-4"})," Add Salesperson"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 text-gray-500 font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Salesperson"}),e.jsx("th",{className:"px-6 py-3",children:"Total Sales (Lifetime)"}),e.jsx("th",{className:"px-6 py-3",children:"Monthly Target"}),e.jsx("th",{className:"px-6 py-3",children:"Quarterly Target"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:E?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-8",children:e.jsx(u,{className:"w-6 h-6 animate-spin mx-auto text-gray-400"})})}):N.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-8 text-gray-400",children:"No salespeople found. Add one to get started."})}):N.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 group transition",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center font-bold text-navy-700",children:(a.name?a.name.charAt(0):a.email.charAt(0)).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-navy-900",children:a.name||"Sales Person"}),e.jsx("div",{className:"text-xs text-gray-500",children:a.email})]})]})}),e.jsx("td",{className:"px-6 py-4 font-semibold text-navy-800",children:p(a.totalSales||0)}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:p(a.target||0)}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:p(a.quarterlyTarget||0)}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("button",{onClick:()=>O(a),className:"opacity-0 group-hover:opacity-100 flex items-center gap-1.5 px-3 py-1.5 bg-white border border-gray-300 rounded-md text-xs font-bold text-gray-700 hover:bg-gray-50 transition",children:[e.jsx(V,{className:"w-3 h-3"})," Set Targets"]})})]},a.id))})]})})}),M&&x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-navy-900/50 backdrop-blur-sm animate-fadeIn",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[e.jsxs("header",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[e.jsxs("h3",{className:"text-lg font-bold text-navy-900 flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-action-600"})," Set Sales Targets"]}),e.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(f,{className:"w-5 h-5"})})]}),e.jsxs("main",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(G,{className:"w-4 h-4 text-blue-600"}),e.jsx("label",{className:"text-sm font-bold text-navy-900",children:"Quarterly Target"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"number",value:n.quarterly,onChange:a=>T("quarterly",a.target.value),className:"w-full pl-9 border-gray-300 rounded-lg text-sm bg-white py-2 focus:ring-2 focus:ring-blue-500 outline-none font-semibold"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(X,{className:"w-4 h-4 text-gray-500"}),e.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Monthly Breakdown"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"number",value:n.monthly,onChange:a=>T("monthly",a.target.value),className:"w-full pl-9 border-gray-300 rounded-lg text-sm bg-white py-2 focus:ring-2 focus:ring-navy-900 outline-none"})]})]})]}),e.jsxs("footer",{className:"px-6 py-4 border-t bg-gray-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200 rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:D,disabled:i,className:"px-4 py-2 bg-navy-900 text-white text-sm font-bold rounded-lg shadow-sm disabled:bg-gray-300 flex items-center gap-2 hover:bg-navy-800 transition",children:[i?e.jsx(u,{className:"w-4 h-4 animate-spin"}):e.jsx(q,{className:"w-4 h-4"}),"Save Targets"]})]})]})}),F&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-navy-900/50 backdrop-blur-sm animate-fadeIn",children:e.jsxs("form",{onSubmit:B,className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[e.jsxs("header",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[e.jsxs("h3",{className:"text-lg font-bold text-navy-900 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-action-600"})," Add New Salesperson"]}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(f,{className:"w-5 h-5"})})]}),e.jsxs("main",{className:"p-6 space-y-4",children:[S&&e.jsxs("p",{className:"text-red-600 text-sm bg-red-50 p-3 rounded border border-red-200 flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"})," ",S]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:"Full Name"}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:a=>g({...s,name:a.target.value}),className:"w-full border-gray-300 rounded-lg text-sm bg-white px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:"Email"}),e.jsx("input",{type:"email",required:!0,value:s.email,onChange:a=>g({...s,email:a.target.value}),className:"w-full border-gray-300 rounded-lg text-sm bg-white px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-1 block",children:"Password"}),e.jsx("input",{type:"password",required:!0,minLength:8,value:s.password,onChange:a=>g({...s,password:a.target.value}),className:"w-full border-gray-300 rounded-lg text-sm bg-white px-3 py-2"})]})]}),e.jsxs("footer",{className:"px-6 py-4 border-t bg-gray-50 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200 rounded-lg transition",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-navy-900 text-white text-sm font-bold rounded-lg shadow-sm disabled:bg-gray-300 flex items-center gap-2 hover:bg-navy-800 transition",children:[i?e.jsx(u,{className:"w-4 h-4 animate-spin"}):e.jsx(q,{className:"w-4 h-4"})," Create User"]})]})]})})]})};export{ae as default};
