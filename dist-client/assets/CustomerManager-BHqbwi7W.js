import{r as a,u as S,j as e,S as A,L as y,X as k,a as x,p as u}from"./index-CFXgF25F.js";import{P as L}from"./plus-CrLdviO7.js";import{U as T}from"./user-B-hCEkTO.js";import{S as R}from"./shield-DKAjzL-5.js";import{T as D}from"./trash-2-BTQl0KlL.js";import{A as E}from"./alert-circle-Bm76VoOK.js";import{S as F}from"./save-VOrKx8th.js";const z=()=>{const[f,i]=a.useState([]),[b,h]=a.useState(!0),[c,j]=a.useState(""),[v,l]=a.useState(!1),[d,p]=a.useState(!1),[n,o]=a.useState({name:"",email:"",password:""}),{showToast:r}=S(),m=async()=>{h(!0);try{const s=await x.get("/users/buyers");if(s&&Array.isArray(s))i(s);else{const t=u.users.getBuyers();i(t)}}catch{const t=u.users.getBuyers();i(t)}finally{h(!1)}};a.useEffect(()=>{m()},[]);const N=async(s,t)=>{if(window.confirm(`Are you sure you want to revoke access for ${t}? This action cannot be undone.`))try{await x.delete(`/users/buyers/${s}`),r("Access revoked.","info")}catch{u.users.delete(s),r("Server unavailable. Revoked locally.","info")}finally{await m()}},w=()=>{o({name:"",email:"",password:""}),l(!0)},C=async s=>{s.preventDefault(),p(!0);try{await x.post("/users/buyers",n)?(r("Customer created successfully.","success"),l(!1),await m()):r("Failed to create customer.","error")}catch(t){r((t==null?void 0:t.message)||"Failed to create customer.","error")}finally{p(!1)}},g=f.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-navy-900",children:"Registered Customers"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage registered buyer accounts and access."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:w,className:"bg-navy-900 hover:bg-navy-800 text-white px-4 py-2 rounded shadow flex items-center gap-2 text-sm font-bold transition",children:[e.jsx(L,{className:"w-4 h-4"})," Add Customer"]}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search customers...",value:c,onChange:s=>j(s.target.value),className:"pl-9 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-navy-900 outline-none w-64 bg-white"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 text-gray-500 font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Customer"}),e.jsx("th",{className:"px-6 py-3",children:"Email"}),e.jsx("th",{className:"px-6 py-3",children:"Joined"}),e.jsx("th",{className:"px-6 py-3",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:b?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-8",children:e.jsx(y,{className:"w-6 h-6 animate-spin mx-auto text-gray-400"})})}):g.length>0?g.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-50 text-blue-600 flex items-center justify-center border border-blue-100",children:e.jsx(T,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-medium text-navy-900",children:s.name})]})}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:s.email}),e.jsx("td",{className:"px-6 py-4 text-gray-500",children:s.joinedAt?new Date(s.joinedAt).toLocaleDateString():"N/A"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-bold flex items-center gap-1 w-fit",children:[e.jsx(R,{className:"w-3 h-3"})," Active"]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("button",{onClick:()=>N(s.id,s.email),className:"text-gray-400 hover:text-red-600 p-1.5 rounded hover:bg-red-50 transition flex items-center gap-1 ml-auto",title:"Revoke Access",children:[e.jsx(D,{className:"w-4 h-4"})," ",e.jsx("span",{className:"text-xs font-medium",children:"Revoke"})]})})]},s.id)):e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"text-center p-8 text-gray-400 flex flex-col items-center",children:[e.jsx(E,{className:"w-8 h-8 mb-2 opacity-50"}),"No customers found matching your search."]})})})]})})}),v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-navy-900/50 backdrop-blur-sm animate-fadeIn",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-bold text-navy-900",children:"Add Customer"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600 transition",children:e.jsx(k,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{id:"customerForm",onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:n.name,onChange:s=>o(t=>({...t,name:s.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-white text-sm focus:ring-2 focus:ring-navy-900 outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:n.email,onChange:s=>o(t=>({...t,email:s.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-white text-sm focus:ring-2 focus:ring-navy-900 outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Temporary Password"}),e.jsx("input",{type:"password",value:n.password,onChange:s=>o(t=>({...t,password:s.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-white text-sm focus:ring-2 focus:ring-navy-900 outline-none",required:!0})]})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200 rounded-lg transition",children:"Cancel"}),e.jsxs("button",{type:"submit",form:"customerForm",disabled:d,className:"px-4 py-2 bg-navy-900 hover:bg-navy-800 text-white text-sm font-bold rounded-lg shadow-sm transition flex items-center gap-2 disabled:opacity-70",children:[d?e.jsx(y,{className:"w-4 h-4 animate-spin"}):e.jsx(F,{className:"w-4 h-4"})," ",d?"Creating...":"Create Customer"]})]})]})})]})};export{z as default};
