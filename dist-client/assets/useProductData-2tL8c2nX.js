import{r as a,f as d}from"./index-CFXgF25F.js";const l=new Map,m=5*60*1e3,w=s=>{const[f,r]=a.useState(null),[i,o]=a.useState(!0),[p,u]=a.useState(null),c=a.useCallback(async()=>{o(!0),u(null);try{const e=s||"all-products",n=l.get(e);if(n&&Date.now()-n.timestamp<m){r(n.data),o(!1);return}if(s){const t=await d(`/products/${s}`);if(t)l.set(e,{data:t,timestamp:Date.now()}),r(t);else throw new Error("Product not found")}else{const t=await d("/products/paginated?limit=100000&offset=0");if(t&&Array.isArray(t.items))l.set(e,{data:t.items,timestamp:Date.now()}),r(t.items);else throw new Error("Unexpected response while loading products")}}catch(e){console.error("Fetching from backend failed.",e),u(e)}finally{o(!1)}},[s]);return a.useEffect(()=>{c()},[c]),{data:f,loading:i,error:p,refresh:c}};export{w as u};
