import{r as c,a as C,j as e,C as k,X as P,f as S}from"./index-CFXgF25F.js";import{D as R}from"./dollar-sign-CrpTMmIA.js";import{U as q}from"./upload-Bi7gtjrF.js";import{F as E}from"./file-text-Bqo2hmfu.js";import{A as F}from"./alert-circle-Bm76VoOK.js";const j={},I=(j==null?void 0:j.VITE_RECAPTCHA_SITE_KEY)||"",T=()=>{const[d,x]=c.useState(!1),[a,g]=c.useState(I),n=c.useRef(!1);c.useEffect(()=>{a||C.get("payments/recaptcha-key").then(s=>{s!=null&&s.key&&g(String(s.key))}).catch(()=>{})},[]);const b=()=>a?window.grecaptcha?(x(!0),Promise.resolve(window.grecaptcha)):n.current?new Promise(s=>{const r=setInterval(()=>{window.grecaptcha&&(x(!0),clearInterval(r),s(window.grecaptcha))},100)}):new Promise((s,r)=>{const t=document.createElement("script");t.src=`https://www.google.com/recaptcha/api.js?render=${a}`,t.async=!0,t.defer=!0,t.onload=()=>{x(!0),n.current=!0,s(window.grecaptcha)},t.onerror=r,document.head.appendChild(t),n.current=!0}):Promise.reject("No site key");return{execute:async s=>{if(!a)return console.warn("Recaptcha missing key"),"";try{const r=await b();return new Promise(t=>{r.ready(async()=>{try{const p=await r.execute(a,{action:s});t(p)}catch(p){console.error("Recaptcha execution failed:",p),t("")}})})}catch(r){return console.error("Recaptcha load failed:",r),""}},isReady:d}},B=({productName:d})=>{const{execute:x}=T(),[a,g]=c.useState("upload"),[n,b]=c.useState({name:"",email:"",company:"",phone:"",competitorPrice:"",partNumber:d||"",notes:""}),[o,s]=c.useState(null),[r,t]=c.useState("idle"),[p,y]=c.useState(""),f=c.useRef(null),m=i=>{const{name:l,value:u}=i.target;b(h=>({...h,[l]:u}))},N=i=>{var u;const l=(u=i.target.files)==null?void 0:u[0];if(l){const h=new FileReader;h.onloadend=()=>{s({name:l.name,content:h.result})},h.readAsDataURL(l)}},v=()=>{s(null),f.current&&(f.current.value="")},w=async i=>{if(i.preventDefault(),a==="upload"&&!o){t("error"),y("Please upload a quote file.");return}t("submitting"),y("");try{const l=await x("beat_quote"),u={...n,fileName:o==null?void 0:o.name,fileContent:o==null?void 0:o.content,recaptchaToken:l};await S("/quotes/request/beat-quote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),t("success"),b({name:"",email:"",company:"",phone:"",competitorPrice:"",partNumber:"",notes:""}),s(null)}catch(l){t("error"),y(l.message||"Something went wrong. Please try again.")}};return r==="success"?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-8 text-center animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(k,{className:"w-8 h-8 text-green-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-navy-900 mb-2",children:"Request Received!"}),e.jsxs("p",{className:"text-gray-600 max-w-md mx-auto",children:["We've received your request",d?` for ${d}`:"",". Our team is reviewing the details and will get back to you with our best price shortly."]}),e.jsx("button",{onClick:()=>t("idle"),className:"mt-6 text-action-600 font-medium hover:text-action-700 underline",children:"Submit another request"})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-action-500 overflow-hidden",children:[e.jsxs("div",{className:"bg-action-600 px-6 py-4 text-white",children:[e.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(R,{className:"w-6 h-6"}),"Got a Better Quote? We'll Beat It!"]}),e.jsxs("p",{className:"text-action-100 text-sm mt-1",children:[d?e.jsxs("span",{className:"font-semibold block mb-1",children:["For: ",d]}):null,"Upload your competitor's quote or tell us their price. We guarantee to match or beat valid quotes."]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6 border-b border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>g("upload"),className:`pb-3 px-1 text-sm font-medium transition-colors relative ${a==="upload"?"text-action-600 border-b-2 border-action-600":"text-gray-500 hover:text-gray-700"}`,children:"Upload Quote File"}),e.jsx("button",{type:"button",onClick:()=>g("price"),className:`pb-3 px-1 text-sm font-medium transition-colors relative ${a==="price"?"text-action-600 border-b-2 border-action-600":"text-gray-500 hover:text-gray-700"}`,children:"Enter Competitor Price"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"name",required:!0,value:n.name,onChange:m,className:"w-full rounded-lg border-gray-300 focus:border-action-500 focus:ring-action-500 sm:text-sm",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Company ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"company",required:!0,value:n.company,onChange:m,className:"w-full rounded-lg border-gray-300 focus:border-action-500 focus:ring-action-500 sm:text-sm",placeholder:"Company Inc."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"email",required:!0,value:n.email,onChange:m,className:"w-full rounded-lg border-gray-300 focus:border-action-500 focus:ring-action-500 sm:text-sm",placeholder:"john@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",value:n.phone,onChange:m,className:"w-full rounded-lg border-gray-300 focus:border-action-500 focus:ring-action-500 sm:text-sm",placeholder:"(555) 123-4567"})]})]}),a==="upload"?e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Upload Quote (PDF, Excel, Image) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),o?e.jsxs("div",{className:"mt-1 flex items-center justify-between p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:"w-8 h-8 text-action-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate max-w-[200px]",children:o.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ready to upload"})]})]}),e.jsx("button",{type:"button",onClick:v,className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:e.jsx(P,{className:"w-5 h-5"})})]}):e.jsxs("div",{onClick:()=>{var i;return(i=f.current)==null?void 0:i.click()},className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(q,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsxs("div",{className:"flex text-sm text-gray-600",children:[e.jsx("span",{className:"relative cursor-pointer rounded-md font-medium text-action-600 hover:text-action-500 focus-within:outline-none",children:"Upload a file"}),e.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, PNG, JPG, XLS up to 10MB"})]}),e.jsx("input",{ref:f,type:"file",name:"fileUpload",className:"hidden",accept:".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg",onChange:N})]})]}):e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Part Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"partNumber",required:a==="price",value:n.partNumber,onChange:m,className:"w-full rounded-lg border-gray-300 focus:border-action-500 focus:ring-action-500 sm:text-sm",placeholder:"e.g. 123-4567"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Competitor Price / Offer ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative rounded-md shadow-sm",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",name:"competitorPrice",required:a==="price",value:n.competitorPrice,onChange:m,className:"block w-full rounded-md border-gray-300 pl-7 focus:border-action-500 focus:ring-action-500 sm:text-sm",placeholder:"0.00"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Please include shipping if applicable."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{name:"notes",rows:2,value:n.notes,onChange:m,className:"w-full rounded-lg border-gray-300 focus:border-action-500 focus:ring-action-500 sm:text-sm",placeholder:"Any specific requirements or details..."})]}),r==="error"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:[e.jsx(F,{className:"w-4 h-4"}),p]}),e.jsx("button",{type:"submit",disabled:r==="submitting",className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-action-600 hover:bg-action-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-action-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r==="submitting"?"Submitting...":"Submit Challenge"})]})]})]})};export{B as default};
