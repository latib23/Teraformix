import{r as d,R as Q,a as p,j as e,S as q,L as C,d as U,A as M,C as H}from"./index-CFXgF25F.js";import V from"./Header-C_SW7nKS.js";import _ from"./Footer-B1Tu_7x4.js";import{A as T}from"./alert-circle-Bm76VoOK.js";import{P as F}from"./package-utPRiDqv.js";import{F as G}from"./file-text-Bqo2hmfu.js";import{T as Y}from"./truck-i18wuND8.js";import"./mail-BAG_jpJT.js";import"./phone-BECx4-5W.js";import"./Image-1076sJ0o.js";import"./log-out-DrwdvGzO.js";import"./upload-Bi7gtjrF.js";import"./shopping-cart-DYMnb0eQ.js";import"./user-B-hCEkTO.js";import"./shield-check-Cy8fN0mD.js";import"./award-B6s_1h76.js";import"./lock-Cz0cqC_5.js";const de=()=>{var v,w,D,R,A;const[h,S]=d.useState(""),[f,O]=d.useState(""),[x,y]=d.useState(!1),[s,u]=d.useState(null),[g,b]=d.useState(""),[N,j]=d.useState(!1),[P,E]=d.useState(!1),k=async r=>{var c,l,o;r.preventDefault(),y(!0),b(""),u(null),j(!1);try{const n=h.trim(),i=f.trim().toLowerCase();try{const a=await p.post("/orders/track",{referenceNumber:n,email:i});if(a&&a.found){const t=a.data;u({type:"ORDER",data:{id:t.id,company:null,total:Number(t.total)||0,paymentMethod:"STRIPE",status:t.status,items:[],createdAt:t.createdAt,shippingAddress:t.shippingAddress,billingAddress:t.billingAddress}});return}}catch{}try{const a=await p.post("/quotes/track",{referenceNumber:n,email:i});if(a&&a.found){const t=a.data,m={id:t.id,type:t.type,submittedAt:t.createdAt,sourceUrl:"",status:t.status==="REVIEWED"?"QUOTE_READY":t.status==="ACCEPTED"?"COMPLETED":t.status==="REJECTED"?"ARCHIVED":"PENDING",data:{name:"",email:i,company:"",phone:"",parts:(c=t.submissionData)==null?void 0:c.parts,timeline:(l=t.submissionData)==null?void 0:l.timeline,fileName:(o=t.submissionData)==null?void 0:o.fileName,quoteNumber:t.referenceNumber}};u({type:"QUOTE",data:m});return}}catch{}b("No record found matching that Reference Number and Email.")}catch{b("An error occurred while tracking. Please try again.")}finally{y(!1),j(!0)}};Q.useEffect(()=>{if(!s||!N||P)return;E(!0);const r=setInterval(async()=>{var c,l,o;try{const n=h.trim(),i=f.trim().toLowerCase();if(s.type==="ORDER"){const a=await p.post("/orders/track",{referenceNumber:n,email:i});if(a&&a.found){const t=a.data;u({type:"ORDER",data:{id:t.id,company:null,total:Number(t.total)||0,paymentMethod:"STRIPE",status:t.status,items:[],createdAt:t.createdAt,shippingAddress:t.shippingAddress,billingAddress:t.billingAddress}})}}else{const a=await p.post("/quotes/track",{referenceNumber:n,email:i});if(a&&a.found){const t=a.data,m={id:t.id,type:t.type,submittedAt:t.createdAt,sourceUrl:"",status:t.status==="REVIEWED"?"QUOTE_READY":t.status==="ACCEPTED"?"COMPLETED":t.status==="REJECTED"?"ARCHIVED":"PENDING",data:{name:"",email:i,company:"",phone:"",parts:(c=t.submissionData)==null?void 0:c.parts,timeline:(l=t.submissionData)==null?void 0:l.timeline,fileName:(o=t.submissionData)==null?void 0:o.fileName,quoteNumber:t.referenceNumber}};u({type:"QUOTE",data:m})}}}catch{}},1e4);return()=>{clearInterval(r),E(!1)}},[s,N]);const I=(r,c)=>{const l=c==="ORDER"?["Processing","Shipped","Delivered"]:["Received","In Review","Quote Ready"],n={PENDING_APPROVAL:0,PROCESSING:0,SHIPPED:1,DELIVERED:2,CANCELLED:-1,PENDING:0,QUOTE_READY:2,COMPLETED:2,ARCHIVED:-1}[r]??0;return r==="CANCELLED"||r==="REJECTED"?e.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-4 text-red-700 flex items-center gap-3 mb-6",children:[e.jsx(T,{className:"w-5 h-5"}),e.jsx("span",{className:"font-bold",children:"This request has been cancelled."})]}):e.jsxs("div",{className:"relative flex justify-between mb-8 mt-4",children:[e.jsx("div",{className:"absolute top-1/2 left-0 w-full h-1 bg-gray-200 -translate-y-1/2 z-0"}),e.jsx("div",{className:"absolute top-1/2 left-0 h-1 bg-action-500 -translate-y-1/2 z-0 transition-all duration-1000",style:{width:`${n/(l.length-1)*100}%`}}),l.map((a,t)=>{const m=t<=n,L=t===n;return e.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 transition-colors duration-300 ${m?"bg-action-500 border-action-500 text-white":"bg-white border-gray-300 text-gray-300"}`,children:m?e.jsx(H,{className:"w-5 h-5"}):e.jsx("div",{className:"w-2 h-2 bg-current rounded-full"})}),e.jsx("span",{className:`text-xs font-bold ${L?"text-navy-900":"text-gray-400"}`,children:a})]},a)})]})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(V,{}),e.jsxs("main",{className:"flex-grow container mx-auto px-4 py-16 flex flex-col items-center",children:[e.jsxs("div",{className:"text-center max-w-2xl mb-10",children:[e.jsx("h1",{className:"text-3xl font-bold text-navy-900 mb-3",children:"Track Order or Quote"}),e.jsx("p",{className:"text-gray-500",children:"Enter your reference number (ORD-... or QTE-...) and email address to check the real-time status of your request."})]}),e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-8 border-b border-gray-100",children:e.jsxs("form",{onSubmit:k,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-navy-900 mb-1",children:"Reference Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:h,onChange:r=>S(r.target.value),placeholder:"e.g. QTE-172930-4821",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-navy-900 outline-none font-mono text-sm",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-navy-900 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:f,onChange:r=>O(r.target.value),placeholder:"procurement@company.com",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-navy-900 outline-none text-sm",required:!0})]}),e.jsx("button",{type:"submit",disabled:x,className:"w-full bg-navy-900 hover:bg-navy-800 text-white font-bold py-3.5 rounded-lg shadow-md transition flex items-center justify-center gap-2",children:x?e.jsx(C,{className:"w-5 h-5 animate-spin"}):"Track Status"})]})}),e.jsxs("div",{className:"bg-gray-50 min-h-[100px]",children:[x&&e.jsxs("div",{className:"flex items-center justify-center h-32 text-gray-500 gap-2",children:[e.jsx(C,{className:"w-6 h-6 animate-spin"})," Searching database..."]}),!x&&N&&!s&&g&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-red-100 text-red-500 mb-3",children:e.jsx(T,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-lg font-bold text-navy-900",children:"Not Found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1 max-w-xs mx-auto",children:g})]}),!x&&s&&e.jsxs("div",{className:"p-8 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded-lg shadow-sm text-action-600",children:s.type==="ORDER"?e.jsx(F,{className:"w-6 h-6"}):e.jsx(G,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider",children:s.type==="ORDER"?"Order":"Quote Request"}),e.jsx("span",{className:"block text-xl font-mono font-bold text-navy-900 tracking-tight",children:s.type==="ORDER"?((v=s.data)==null?void 0:v.referenceNumber)||s.data.id:((w=s.data.data)==null?void 0:w.quoteNumber)||"Unknown"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"block text-xs text-gray-500",children:"Date"}),e.jsx("span",{className:"font-medium text-navy-900",children:s.type==="ORDER"?new Date(s.data.createdAt).toLocaleDateString():new Date(s.data.submittedAt).toLocaleDateString()})]})]}),I(s.data.status,s.type),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-5 mt-6",children:[e.jsx("h4",{className:"text-sm font-bold text-navy-900 mb-3 border-b border-gray-100 pb-2",children:"Details"}),s.type==="ORDER"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Status"}),e.jsx("span",{className:"font-bold text-navy-900",children:s.data.status})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total"}),e.jsxs("span",{className:"font-bold text-navy-900",children:["$",Number(s.data.total).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Items"}),e.jsxs("span",{className:"font-medium text-navy-900",children:[((D=s.data.items)==null?void 0:D.length)||0," Product(s)"]})]}),s.data.status==="SHIPPED"&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-100 flex items-center justify-between bg-blue-50 p-3 rounded",children:[e.jsxs("span",{className:"text-blue-700 font-bold flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"})," Shipment in transit"]}),e.jsx("span",{className:"font-mono text-blue-800",children:"Contact support for tracking details"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Status"}),e.jsx("span",{className:"font-bold text-navy-900",children:s.data.status==="QUOTE_READY"?"Quote Ready":s.data.status==="COMPLETED"?"Completed":s.data.status==="ARCHIVED"?"Archived":"Received"})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600 block mb-1",children:"Request"}),e.jsx("p",{className:"font-medium text-navy-900 line-clamp-2 bg-gray-50 p-2 rounded border border-gray-100",children:((R=s.data.data)==null?void 0:R.parts)||((A=s.data.data)==null?void 0:A.fileName)||"BOM Upload"})]}),s.data.status==="QUOTE_READY"&&e.jsx("div",{className:"mt-4",children:e.jsx("button",{className:"w-full py-2 bg-action-600 text-white text-sm font-bold rounded hover:bg-action-500 transition",children:"Download Official Quote (PDF)"})})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(U,{to:"/account",className:"text-sm font-semibold text-navy-700 hover:text-action-600 flex items-center justify-center gap-1",children:["Login to view full history ",e.jsx(M,{className:"w-4 h-4"})]})})]})]})]})]}),e.jsx(_,{})]})};export{de as default};
